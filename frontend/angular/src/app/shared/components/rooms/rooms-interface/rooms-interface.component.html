<div class="w-full h-full pt-4 md:pt-8 lg:pt-12">
  <div class="flex flex-col h-full relative font-sans bg-gray-50 rounded-lg md:rounded-xl shadow-md md:shadow-lg p-3 md:p-5 overflow-hidden">
    
    <!-- Controles del mapa con Tailwind -->
    <div class="absolute bottom-3 sm:bottom-4 md:bottom-6 left-3 sm:left-4 md:left-6 flex gap-1 sm:gap-2 z-10 backdrop-blur-md bg-white/80 p-1 sm:p-1.5 rounded-lg shadow-md">
      <button class="bg-white border border-gray-200 rounded-md w-8 h-8 sm:w-9 sm:h-9 flex items-center justify-center cursor-pointer shadow-sm transition-all hover:bg-gray-50 hover:shadow hover:-translate-y-0.5 text-gray-600" (click)="zoom(1.1, 400, 300)">+</button>
      <button class="bg-white border border-gray-200 rounded-md w-8 h-8 sm:w-9 sm:h-9 flex items-center justify-center cursor-pointer shadow-sm transition-all hover:bg-gray-50 hover:shadow hover:-translate-y-0.5 text-gray-600" (click)="zoom(0.9, 400, 300)">-</button>
      <button class="bg-white border border-gray-200 rounded-md px-2 sm:px-3 h-8 sm:h-9 flex items-center justify-center cursor-pointer shadow-sm transition-all hover:bg-gray-50 hover:shadow hover:-translate-y-0.5 text-gray-600 text-xs sm:text-sm font-medium" (click)="resetView()">Resetear</button>
    </div>
    
    <!-- Contenedor del mapa con Tailwind -->
    <div class="flex-1 overflow-hidden relative bg-white border border-gray-200 rounded-lg shadow-sm mb-3 md:mb-5 transition-all hover:shadow-md">
      <svg #mapSvg width="100%" height="100%" viewBox="0 0 1000 500" preserveAspectRatio="xMidYMid meet" class="min-h-[300px] sm:min-h-[400px] md:min-h-[500px] cursor-grab active:cursor-grabbing" (click)="onMapBackgroundClick()">
        <!-- Definiciones de gradientes para los tipos de habitaciones -->
        <defs>
          <pattern id="pattern-grid" width="20" height="20" patternUnits="userSpaceOnUse">
            <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#f0f0f0" stroke-width="0.5"/>
          </pattern>
          
          <linearGradient id="gradient-room" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#ffedd5" />
            <stop offset="100%" stop-color="#fed7aa" />
          </linearGradient>
          
          <linearGradient id="gradient-common" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#f3e8ff" />
            <stop offset="100%" stop-color="#e9d5ff" />
          </linearGradient>
          
          <linearGradient id="gradient-kitchen" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#e0f2fe" />
            <stop offset="100%" stop-color="#bae6fd" />
          </linearGradient>
          
          <linearGradient id="gradient-bath" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#dbeafe" />
            <stop offset="100%" stop-color="#93c5fd" />
          </linearGradient>
          
          <linearGradient id="gradient-laundry" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#fef3c7" />
            <stop offset="100%" stop-color="#fde68a" />
          </linearGradient>
          
          <linearGradient id="gradient-dining" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#dcfce7" />
            <stop offset="100%" stop-color="#bbf7d0" />
          </linearGradient>

          <!-- Marcador de flecha para la rosa de vientos -->
          <marker id="arrowhead" markerWidth="6" markerHeight="6" refX="0" refY="3" orient="auto">
            <polygon points="0 0, 6 3, 0 6" fill="#3b82f6" />
          </marker>

          <!-- Símbolos para usar en lugar de iconos FontAwesome -->
          <symbol id="icon-bed" viewBox="0 0 24 24">
            <path d="M7,13V5C7,3.9 7.9,3 9,3H15C16.1,3 17,3.9 17,5V7H19V13H7M17,11V9H9V11H17Z" />
          </symbol>
          
          <symbol id="icon-couch" viewBox="0 0 24 24">
            <path d="M21,9V7A2,2 0 0,0 19,5H5A2,2 0 0,0 3,7V9C1.9,9 1,9.9 1,11V17A2,2 0 0,0 3,19V21H5V19H19V21H21V19A2,2 0 0,0 23,17V11C23,9.9 22.1,9 21,9M5,7H19V9H5V7M21,17H3V11H21V17Z" />
          </symbol>
          
          <symbol id="icon-shower" viewBox="0 0 24 24">
            <path d="M17,5V9H21V5H17M17,13V21H21V13H17M5,13V17H9V13H5M5,5V9H9V5H5M13,5V9H9V12H5V21H9V17H13V21H17V13H13V9H17V5H13Z" />
          </symbol>
          
          <symbol id="icon-utensils" viewBox="0 0 24 24">
            <path d="M8.1,13.34L3.91,9.16C2.35,7.59 2.35,5.06 3.91,3.5L10.93,10.5L8.1,13.34M13.41,13L20.29,19.88L18.88,21.29L12,14.41L5.12,21.29L3.71,19.88L13.36,10.22L13.16,10L14.22,8.95L15.41,9.22L13.41,13M17.67,1.5L14.43,4.74L15.46,5.77L18.7,2.53L17.67,1.5M20.91,4.74L17.67,7.98L18.7,9L21.94,5.77L20.91,4.74Z" />
          </symbol>
          
          <symbol id="icon-wash" viewBox="0 0 24 24">
            <path d="M14.83,11.17C16.39,12.73 16.39,15.27 14.83,16.83C13.27,18.39 10.73,18.39 9.17,16.83L14.83,11.17M6,2H18A2,2 0 0,1 20,4V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V4A2,2 0 0,1 6,2M7,4A1,1 0 0,0 6,5A1,1 0 0,0 7,6A1,1 0 0,0 8,5A1,1 0 0,0 7,4M12,4A1,1 0 0,0 11,5A1,1 0 0,0 12,6A1,1 0 0,0 13,5A1,1 0 0,0 12,4M17,4A1,1 0 0,0 16,5A1,1 0 0,0 17,6A1,1 0 0,0 18,5A1,1 0 0,0 17,4Z" />
          </symbol>

          <symbol id="icon-tree" viewBox="0 0 24 24">
            <path d="M12,3L1,9L12,15L21,10.09V17H23V9M5,13.18V17.18L12,21L19,17.18V13.18L12,17L5,13.18Z" />
          </symbol>

          <symbol id="icon-door" viewBox="0 0 24 24">
            <path d="M8,3C6.89,3 6,3.89 6,5V21H18V5C18,3.89 17.11,3 16,3H8M8,5H16V19H8V5M13,11V13H15V11H13Z" />
          </symbol>
        </defs>
        
        <g class="map-content">
          <!-- Fondo del mapa con patrón de cuadrícula -->
          <rect width="1000" height="500" fill="white"></rect>
          <rect width="1000" height="500" fill="url(#pattern-grid)"></rect>
          
          <!-- Marco del edificio -->
          <rect x="50" y="50" width="900" height="400" fill="white" stroke="#64748b" stroke-width="3"></rect>
          
          <!-- Pasillos horizontales -->
          <rect x="60" y="160" width="880" height="30" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1"></rect>
          <rect x="60" y="310" width="880" height="30" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1"></rect>
          
          <!-- Pasillo vertical -->
          <rect x="500" y="190" width="30" height="120" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1"></rect>
          
          <!-- HABITACIONES GENERADAS DINÁMICAMENTE -->
          <ng-container *ngFor="let room of rooms">
            <!-- Rectángulo de la habitación -->
            <rect 
              [attr.id]="room.id" 
              [attr.x]="getRoomCoords(room).x"
              [attr.y]="getRoomCoords(room).y"
              [attr.width]="getRoomCoords(room).width"
              [attr.height]="getRoomCoords(room).height"
              [attr.fill]="getRoomFill(room.id)"
              [attr.stroke]="getRoomStroke(room.id)"
              stroke-width="1.5"
              class="transition-colors duration-300 cursor-pointer hover:stroke-[2.5px]"
              (click)="onRoomClick(room.id, $event)">
            </rect>
            
            <!-- Texto de la habitación -->
            <text 
              [attr.x]="getRoomCenter(room).x"
              [attr.y]="getRoomCenter(room).y + 5"
              text-anchor="middle" 
              class="text-sm font-semibold"
              fill="#374151">
              {{room.name}}
            </text>
            
            <!-- Icono según el tipo de habitación -->
            <use 
              [attr.href]="getRoomIcon(room.id)"
              width="20" 
              height="20" 
              [attr.x]="getRoomCenter(room).x - 10"
              [attr.y]="getRoomCenter(room).y - 20"
              fill="#78716c" />
          </ng-container>
          
          <!-- Entrada principal -->
          <rect x="20" y="160" width="40" height="30" fill="#bfdbfe" stroke="#3b82f6" stroke-width="2"></rect>
          <text x="40" y="180" text-anchor="middle" class="text-xs font-semibold" fill="#1e40af">ENTRADA</text>
          <use href="#icon-door" width="16" height="16" x="32" y="172" fill="#1e40af" />
          
          <!-- Leyendas del mapa -->
          <text x="20" y="30" class="text-xl font-bold" fill="#1f2937">RESIDENCIA ESTUDIANTIL</text>
          <text x="20" y="50" class="text-sm" fill="#4b5563">PLANO PLANTA 1</text>
          
          <!-- Rosa de los vientos -->
          <g transform="translate(950, 50)">
            <circle cx="0" cy="0" r="15" fill="white" stroke="#94a3b8" stroke-width="1"></circle>
            <text x="0" y="-5" text-anchor="middle" class="text-xs font-bold" fill="#1f2937">N</text>
            <text x="0" y="12" text-anchor="middle" class="text-xs font-bold" fill="#6b7280">S</text>
            <text x="-7" y="4" text-anchor="middle" class="text-xs font-bold" fill="#6b7280">O</text>
            <text x="7" y="4" text-anchor="middle" class="text-xs font-bold" fill="#6b7280">E</text>
            <path d="M0,0 L0,-12" stroke="#3b82f6" stroke-width="1.5" marker-end="url(#arrowhead)"></path>
          </g>
          
          <!-- Escala -->
          <line x1="850" y1="460" x2="950" y2="460" stroke="#64748b" stroke-width="1"></line>
          <line x1="850" y1="455" x2="850" y2="465" stroke="#64748b" stroke-width="1"></line>
          <line x1="950" y1="455" x2="950" y2="465" stroke="#64748b" stroke-width="1"></line>
          <text x="900" y="480" text-anchor="middle" class="text-xs" fill="#64748b">10 metros</text>
        </g>
      </svg>
    </div>

    <!-- Panel de información con Tailwind -->
    <div *ngIf="selectedRoom" class="bg-white border border-gray-200 rounded-lg shadow-md p-3 sm:p-4 mb-3 transition-all animate-fade-in">
      <div class="flex justify-between items-center mb-2 sm:mb-3 pb-2 border-b border-amber-500">
        <h3 class="text-base sm:text-lg font-semibold text-gray-800">{{selectedRoom!.name}}</h3>
        <button class="text-gray-400 hover:text-gray-600 transition-colors" (click)="onMapBackgroundClick()">×</button>
      </div>
      <div class="space-y-3 sm:space-y-4">
        <p class="text-sm sm:text-base text-gray-600">{{selectedRoom!.description}}</p>
        <div class="flex justify-end pt-1 sm:pt-2">
          <button class="bg-amber-500 hover:bg-amber-600 text-white py-1.5 sm:py-2 px-3 sm:px-4 rounded-lg text-xs sm:text-sm font-medium transition-all flex items-center" (click)="openDetailsModal(selectedRoom)">
            Ver Detalles
          </button>
        </div>
      </div>
    </div>
    
<!-- Leyenda del mapa con Tailwind -->
<div *ngIf="!selectedRoom" class="hidden sm:block absolute bottom-3 sm:bottom-4 md:bottom-6 right-3 sm:right-4 md:right-6 bg-white/90 backdrop-blur-md p-3 sm:p-4 rounded-lg shadow-md z-10 border border-gray-200/80 max-w-[220px]">
  <h4 class="mt-0 mb-2 sm:mb-3 text-sm sm:text-base font-semibold text-gray-700 border-b-2 border-amber-500 pb-1 sm:pb-1.5">Leyenda</h4>
  
  <div class="space-y-2 sm:space-y-2.5">
    <div class="flex items-center">
      <div class="w-4 sm:w-5 h-4 sm:h-5 rounded bg-gradient-to-br from-[#ffedd5] to-[#fed7aa] border border-[#fb923c] mr-2 sm:mr-3 shadow-sm"></div>
      <span class="text-xs sm:text-sm text-gray-700">Habitaciones</span>
    </div>
    
    <div class="flex items-center">
      <div class="w-4 sm:w-5 h-4 sm:h-5 rounded bg-gradient-to-br from-[#f3e8ff] to-[#e9d5ff] border border-[#a855f7] mr-2 sm:mr-3 shadow-sm"></div>
      <span class="text-xs sm:text-sm text-gray-700">Áreas comunes</span>
    </div>
    
    <div class="flex items-center">
      <div class="w-4 sm:w-5 h-4 sm:h-5 rounded bg-gradient-to-br from-[#e0f2fe] to-[#bae6fd] border border-[#0284c7] mr-2 sm:mr-3 shadow-sm"></div>
      <span class="text-xs sm:text-sm text-gray-700">Servicios</span>
    </div>
    
    <div class="flex items-center">
      <div class="w-4 sm:w-5 h-4 sm:h-5 rounded bg-gradient-to-br from-[#dcfce7] to-[#bbf7d0] border border-[#10b981] mr-2 sm:mr-3 shadow-sm"></div>
      <span class="text-xs sm:text-sm text-gray-700">Comedor</span>
    </div>
    
    <div class="flex items-center">
      <div class="w-4 sm:w-5 h-4 sm:h-5 rounded bg-gradient-to-br from-[#fef3c7] to-[#fde68a] border border-[#f59e0b] mr-2 sm:mr-3 shadow-sm"></div>
      <span class="text-xs sm:text-sm text-gray-700">Lavandería</span>
    </div>
  </div>
</div>